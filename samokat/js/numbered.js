var e,t;e=this,t=function(){"use strict";var u={mask:"+7 (###) ### - ## - ##",numbered:"#",empty:"_",placeholder:!1};return function(e,t){var f=this;for(var n in"object"!=typeof e?f.inputs=document.querySelectorAll(e):void 0!==e.length?f.inputs=e:f.inputs=[e],f.inputs=Array.prototype.slice.call(f.inputs),t=t||(void 0!==f.inputs[0].numbered?f.inputs[0].numbered.params:{}),u)void 0===t[n]&&(t[n]=u[n]);for(var a in f.params=t,f.config={},f.config.placeholder=f.params.mask.replace(new RegExp(f.params.numbered,"g"),f.params.empty),f.config.numbered=f.params.numbered.replace(/([()[\]\.^\#$|?+-])/g,"\\\\$1"),f.config.numberedCol=f.params.mask.split(f.params.numbered).length-1,f.config.empty=f.params.empty.replace(/([()[\]\.^\#$|?+-])/g,"\\$1"),f.config.mask=f.params.mask.replace(/([()[\]\.^\#$|?+-])/g,"\\$1").replace(new RegExp(f.config.numbered,"g"),"(\\d)"),f.config.maskNums=f.params.mask.replace(/[^\d]/gi,"").split(""),f.config.maskNumsCol=f.config.maskNums.length,f.config.regexp=new RegExp("^"+f.config.mask+"$"),f.config.events=["input","change","click","focusin","blur"],f._eventFire=function(e,t){if(e.fireEvent)e.fireEvent("on"+t);else{var n=document.createEvent("Events");n.initEvent(t,!0,!1),e.dispatchEvent(n)}},f._getSelectionRange=function(e){var t={text:"",start:0,end:0,length:0};if(e.setSelectionRange)t.start=e.selectionStart,t.end=e.selectionEnd,t.text=t.start!=t.end?e.value.substring(t.start,t.end):"";else if(document.selection){var n;if(e.tagName&&"TEXTAREA"===e.tagName){var a=document.selection.createRange().duplicate();n=e.createTextRange();var r=a.getBookmark();n.moveToBookmark(r)}else n=document.selection.createRange().duplicate();for(t.text=n.text;0!==n.moveStart("character",-1);t.start++);t.end=t.text.length+t.start}return t.length=t.text.length,t},f.magic=function(e){var t=this.numbered,n=t.input.value||" ",a=n.replace(/[^\d]/gi,"").split("").join("").split(""),r=a.length,i=0,s=-1,u=-1,p=(f._getSelectionRange(t.input),0),o=[],c=t.params.mask.split("");for(var l in c){var m=c[l];l=parseInt(l),p<=t.config.maskNumsCol&&m==t.config.maskNums[p]&&m==a[i]?(o.push(m),p++,i++):m==t.params.numbered?(s<0&&(s=l),i<r?(o.push(a[i]),i++,u=l):o.push(t.params.empty)):o.push(m)}n=o.join("");var g=0<=u?u+1:s;if("click"!==e.type&&("blur"!==e.type&&"change"!==e.type||i-p!=0||t.params.placeholder?t.oldValue===t.input.value&&"focusin"!==e.type||(this.value=n):this.value=""),"change"!==e.type&&"blur"!==e.type&&("click"!==e.type||"focusin"===t.lastEvent&&"click"===e.type))if(t.input.setSelectionRange)t.input.setSelectionRange(g,g);else if(t.input.createTextRange){var v=t.input.createTextRange();v.collapse(!0),v.moveEnd("character",g),v.moveStart("character",g),v.select()}return t.oldValue=this.value,t.lastEvent=e.type,e.target},f.inputs){var r=f.inputs[a],i=!1;if("Ð¾bject"!=typeof r.numbered&&void 0===r.numbered||(i=!0),r.numbered={input:f.inputs[a],config:f.config,params:f.params,oldValue:!1},!i){for(var s in f.config.events)r.addEventListener(f.config.events[s],f.magic);f._eventFire(r,"blur")}f.inputs[a]=r}return f.destroy=function(){var e=this;for(var t in e.inputs){var n=e.inputs[t];for(var a in e.config.events)n.removeEventListener(e.config.events[a],e.magic),n.numbered=null}return null},f.validate=function(e){var t=e||!1,n=1<this.inputs.length&&[],a=!1!==t?[t]:this.inputs;for(var r in a){var i;a[r];i=a[r].numbered.config.regexp.test(a[r].numbered.input.value)?1:""===a[r].numbered.input.value||a[r].numbered.input.value===a[r].numbered.config.placeholder?0:-1,1<a.length?n.push(i):n=i}return n},f.reInit=function(){var e=this,t=1<e.inputs.length&&[];for(var n in e.inputs){var a=e.inputs[n];e._eventFire(a,"blur")}return t},f.setVal=function(e){var t=1<this.inputs.length&&[];for(var n in this.inputs){var a=this.inputs[n];a.value=e,this._eventFire(a,"blur")}return t},f.getVal=function(e){var t=e||!1,n=[];for(var a in this.inputs){var r=this.inputs[a],i=r.value;if(t)if(0<this.validate(r)){var s=i.match(this.config.regexp);i=s.slice(1,s.length).join("")}else i=r.value.replace(/[^\d]/gi,"");n.push(i)}return 1<n.length?n:n[0]},f}},"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.Numbered=t();